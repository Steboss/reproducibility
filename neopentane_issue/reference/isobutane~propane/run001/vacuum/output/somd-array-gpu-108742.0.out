CUDA DEVICES: 0
lambda is:  0.0000
"/home/julien/sire.app/share/Sire/scripts/somd-freenrg.py" 
Reading topology file "../../input/SYSTEM.top" 
Reading coordinate file "../../input/SYSTEM.crd" 
Building 1 molecule(s)... 
 Getting space information  
Read space "Infinite cartesian space" 
...complete 

Loading configuration information from file sim.cfg

 
Running a somd-freenrg calculation using files ../../input/SYSTEM.top, ../../input/SYSTEM.crd and ../../input/MORPH.pert.
Using parameters:
===============
andersen == True
barostat == False
buffered coordinates frequency == 500
center solute == True
constraint == allbonds
crdfile == ../../input/SYSTEM.crd
cutoff type == nocutoff
energy frequency == 100
equilibrate == False
equilibration iterations == 5000
lambda array == (0.0, 0.0625, 0.125, 0.1875, 0.25, 0.3125, 0.375, 0.4375, 0.5, 0.5625, 0.625, 0.6875, 0.75, 0.8125, 0.875, 0.9375, 1.0)
lambda_val == 0.0
minimal coordinate saving == True
minimize == True
morphfile == ../../input/MORPH.pert
ncycles == 100
nmoves == 10000
platform == CUDA
precision == mixed
save coordinates == True
topfile == ../../input/SYSTEM.top
===============

### Running Single Topology Molecular Dynamics Free Energy on node011 ###
###================Setting up calculation=====================###
New run. Loading input and creating restart
lambda is 0.0
Create the System...
Selecting dummy groups
Creating force fields... 
Setting up the simulation with random seed 964311
Setting up moves...
Created a MD move that uses OpenMM for all molecules on 0 
Generated random seed number 964311 
Saving restart
Setting up sim file. 
There are 14 atoms in the group 
###===========================================================###

###====================somd-freenrg run=======================###
Starting somd-freenrg run...
10000 moves 100 cycles, 2000 ps simulation time

Cycle =  1 


Cycle =  2 


Cycle =  3 


Cycle =  4 


Cycle =  5 


Cycle =  6 


Cycle =  7 


Cycle =  8 


Cycle =  9 


Cycle =  10 


Cycle =  11 


Cycle =  12 


Cycle =  13 


Cycle =  14 


Cycle =  15 


Cycle =  16 


Cycle =  17 


Cycle =  18 


Cycle =  19 


Cycle =  20 


Cycle =  21 


Cycle =  22 


Cycle =  23 


Cycle =  24 


Cycle =  25 


Cycle =  26 


Cycle =  27 


Cycle =  28 


Cycle =  29 


Cycle =  30 


Cycle =  31 


Cycle =  32 


Cycle =  33 


Cycle =  34 


Cycle =  35 


Cycle =  36 


Cycle =  37 


Cycle =  38 


Cycle =  39 


Cycle =  40 


Cycle =  41 


Cycle =  42 


Cycle =  43 


Cycle =  44 


Cycle =  45 


Cycle =  46 


Cycle =  47 


Cycle =  48 


Cycle =  49 


Cycle =  50 


Cycle =  51 


Cycle =  52 


Cycle =  53 


Cycle =  54 


Cycle =  55 


Cycle =  56 


Cycle =  57 


Cycle =  58 


Cycle =  59 


Cycle =  60 


Cycle =  61 


Cycle =  62 


Cycle =  63 


Cycle =  64 


Cycle =  65 


Cycle =  66 


Cycle =  67 


Cycle =  68 


Cycle =  69 


Cycle =  70 


Cycle =  71 


Cycle =  72 


Cycle =  73 


Cycle =  74 


Cycle =  75 


Cycle =  76 


Cycle =  77 


Cycle =  78 


Cycle =  79 


Cycle =  80 


Cycle =  81 


Cycle =  82 


Cycle =  83 


Cycle =  84 


Cycle =  85 


Cycle =  86 


Cycle =  87 


Cycle =  88 


Cycle =  89 


Cycle =  90 


Cycle =  91 


Cycle =  92 


Cycle =  93 


Cycle =  94 


Cycle =  95 


Cycle =  96 


Cycle =  97 


Cycle =  98 


Cycle =  99 


Cycle =  100 

Simulation took 520 s 
###===========================================================###

Clearing buffers...
Backing up previous restart
Saving new restart
Starting /home/julien/sire.app/bin/somd-freenrg: number of threads equals 32
"/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py" 
Traceback (most recent call last):
  File "/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py", line 260, in processFreeEnergies
    pmf = nrg.sum()
AttributeError: 'Gradients' object has no attribute 'sum'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py", line 268, in <module>
    results.append(processFreeEnergies(freenrgs, FILE))
  File "/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py", line 262, in processFreeEnergies
    pmf = nrg.integrate()
UserWarning: Exception 'SireMaths::math_error' thrown by the thread 'master:main'.
Cannot fit the polynomial as the matrix is singular.
Thrown from FILE: /home/julien/software/devel/sire/corelib/src/libs/SireAnalysis/third_party/regress.cpp, LINE: 224, FUNCTION: void Regress::DoPolynomial(unsigned int)
__Backtrace__
(  0) /home/julien/sire.app/bin/../lib/libSireError.so.2015 ([0x2afc4d4a50f5] ++0x25)
  -- SireError::getBackTrace()

(  1) /home/julien/sire.app/bin/../lib/libSireError.so.2015 ([0x2afc4d4a2336] ++0x96)
  -- SireError::exception::exception(QString, QString)

/home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015(+0x5b1f4) [0x2afc533771f4]
/home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015(+0x5ac87) [0x2afc53376c87]
/home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015(+0x5afa1) [0x2afc53376fa1]
/home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015(+0x5b012) [0x2afc53377012]
(  6) /home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015 ([0x2afc5335c727] ++0x517)
  -- SireAnalysis::TIPMF::recalculate()

(  7) /home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015 ([0x2afc5335e55d] ++0x5d)
  -- SireAnalysis::TIPMF::setGradients(QVector<SireAnalysis::DataPoint> const&)

(  8) /home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015 ([0x2afc5335ff86] ++0x46)
  -- SireAnalysis::Gradients::integrate(double, double, int) const

(  9) /home/julien/sire.app/bin/../lib/libSireAnalysis.so.2015 ([0x2afc53360b23] ++0x43)
  -- SireAnalysis::Gradients::integrate() const

/home/julien/sire.app/lib/python3.5/site-packages/Sire/Analysis/_Analysis.so(+0x50466) [0x2afc530b2466]
( 11) /home/julien/sire.app/bin/../lib/libboost_python.so ([0x2afc513e2665] ++0x1b5)
  -- boost::python::objects::function::call(_object*, _object*) const

/home/julien/sire.app/bin/../lib/libboost_python.so(+0x29898) [0x2afc513e2898]
( 13) /home/julien/sire.app/bin/../lib/libboost_python.so ([0x2afc513d6703] ++0x43)
  -- boost::python::detail::exception_handler::operator()(boost::function0<void> const&) const

/home/julien/sire.app/lib/python3.5/site-packages/Sire/Error/_Error.so(+0x24b0) [0x2afc516094b0]
( 15) /home/julien/sire.app/bin/../lib/libboost_python.so ([0x2afc513d66e6] ++0x26)
  -- boost::python::detail::exception_handler::operator()(boost::function0<void> const&) const

/home/julien/sire.app/lib/python3.5/site-packages/Sire/Error/_Error.so(+0x246e) [0x2afc5160946e]
( 17) /home/julien/sire.app/bin/../lib/libboost_python.so ([0x2afc513d64e9] ++0x29)
  -- boost::python::handle_exception_impl(boost::function0<void>)

/home/julien/sire.app/bin/../lib/libboost_python.so(+0x280c4) [0x2afc513e10c4]
( 19) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c6d4056] ++0x56)
  -- PyObject_Call

( 20) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7af0b2] ++0x7ac2)
  -- PyEval_EvalFrameEx

( 21) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7afdd1] ++0x87e1)
  -- PyEval_EvalFrameEx

/home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0(+0x144349) [0x2afc4c7b1349]
( 23) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7b14d8] ++0x48)
  -- PyEval_EvalCodeEx

( 24) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7b151b] ++0x3b)
  -- PyEval_EvalCode

( 25) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7d6750] ++0x130)
  -- PyRun_FileExFlags

( 26) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7d7d23] ++0x173)
  -- PyRun_SimpleFileExFlags

( 27) /home/julien/sire.app/bin/../lib/libpython3.5m.so.1.0 ([0x2afc4c7f2e97] ++0xca7)
  -- Py_Main

/home/julien/sire.app/bin/analyse_freenrg() [0x403012]
( 29) /lib/x86_64-linux-gnu/libc.so.6 ([0x2afc4e32aec5] ++0xf5)
  -- __libc_start_main

/home/julien/sire.app/bin/analyse_freenrg() [0x403b20]
__EndTrace__
Exception 'SireMaths::math_error' thrown by the thread 'master:main'.
Cannot fit the polynomial as the matrix is singular.
Thrown from FILE: /home/julien/software/devel/sire/corelib/src/libs/SireAnalysis/third_party/regress.cpp, LINE: 224, FUNCTION: void Regress::DoPolynomial(unsigned int)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py", line 271, in <module>
    results.append(processFreeEnergies(freenrg, FILE))
  File "/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py", line 219, in processFreeEnergies
    nrgs.merge(0, 0)
Boost.Python.ArgumentError: Python argument types in
    Gradients.merge(int, int)
did not match C++ signature:
    merge(QList<SireAnalysis::Gradients> gradients)
!!!WARNING: at the moment the gradietns values are multiply by 0.593 kcal/mol!!!
Looking for simfile.dat files
Found in these folders simfile.dat

['/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.0000/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.0625/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.1250/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.1875/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.2500/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.3125/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.3750/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.4375/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.5000/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.5625/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.6250/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.6875/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.7500/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.8125/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.8750/simfile.dat']
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.0000.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.0625.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.1250.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.1875.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.2500.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.3125.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.3750.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.4375.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.5000.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.5625.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.6250.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.6875.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.7500.dat
/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/analysis_gro/lambda-0.8125.dat
Traceback (most recent call last):
  File "analysis_alchemical.py", line 50, in <module>
    index_start = read_file.index('#   [step]      [potential kcal/mol]       [gradient kcal/mol]      [forward Metropolis]     [backward Metropolis]                   [u_kl]\n') +1
ValueError: '#   [step]      [potential kcal/mol]       [gradient kcal/mol]      [forward Metropolis]     [backward Metropolis]                   [u_kl]\n' is not in list
Started on Thu Apr 28 10:53:58 2016
Reading metadata from ./lambda-0.6250.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.4375.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.0000.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.1875.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.5000.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.5625.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.0625.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.2500.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.8125.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.3750.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.6875.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.7500.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.1250.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.3125.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...

Loading in data from ./lambda-0.0000.dat (state 0) ...
Loading in data from ./lambda-0.0625.dat (state 1) ...
Loading in data from ./lambda-0.1250.dat (state 2) ...
Loading in data from ./lambda-0.1875.dat (state 3) ...
Loading in data from ./lambda-0.2500.dat (state 4) ...
Loading in data from ./lambda-0.3125.dat (state 5) ...
Loading in data from ./lambda-0.3750.dat (state 6) ...
Loading in data from ./lambda-0.4375.dat (state 7) ...
Loading in data from ./lambda-0.5000.dat (state 8) ...
Loading in data from ./lambda-0.5625.dat (state 9) ...
Loading in data from ./lambda-0.6250.dat (state 10) ...
Loading in data from ./lambda-0.6875.dat (state 11) ...
Loading in data from ./lambda-0.7500.dat (state 12) ...
Loading in data from ./lambda-0.8125.dat (state 13) ...

Estimating the free energy change with TI-CUBIC...
------------ ----------------------- 
   States      TI-CUBIC (kcal/mol)   
------------ ----------------------- 
   0 -- 1        -0.6391  +-  0.0021 
   1 -- 2        -0.3381  +-  0.0016 
   2 -- 3        -0.1757  +-  0.0012 
   3 -- 4        -0.0888  +-  0.0009 
   4 -- 5        -0.0465  +-  0.0007 
   5 -- 6        -0.0274  +-  0.0006 
   6 -- 7        -0.0178  +-  0.0005 
   7 -- 8        -0.0167  +-  0.0006 
   8 -- 9        -0.0197  +-  0.0006 
   9 -- 10       -0.0214  +-  0.0006 
  10 -- 11       -0.0238  +-  0.0006 
  11 -- 12       -0.0270  +-  0.0006 
  12 -- 13       -0.0296  +-  0.0006 
------------ ----------------------- 
    TOTAL:       -1.4717  +-  0.0043 

************************************
   The above table has been stored in   
             ./results.txt              
     while the full-precision data      
 (along with the simulation profile) in 
            ./results.pickle            
************************************

Time spent: 0 hours, 0 minutes, and 2.92 seconds.
Finished on Thu Apr 28 10:54:01 2016
Submitted batch job 108871
Traceback (most recent call last):
  File "extract_results.py", line 39, in <module>
    mbar = open("freenrg-MBAR.dat", "r")
IOError: [Errno 2] No such file or directory: 'freenrg-MBAR.dat'
Looking for gradients.dat files
Found in these folders gradients dat

['/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.0000/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.0625/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.1250/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.1875/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.2500/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.3125/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.3750/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.4375/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.5000/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.5625/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.6250/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.6875/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.7500/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.8125/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/isobutane~propane/run001/vacuum/output/lambda-0.8750/gradients.dat']
Processing lambda_val	0.0000
Processing lambda_val	0.0625
Processing lambda_val	0.1250
Processing lambda_val	0.1875
Processing lambda_val	0.2500
Processing lambda_val	0.3125
Processing lambda_val	0.3750
Processing lambda_val	0.4375
Processing lambda_val	0.5000
Processing lambda_val	0.5625
Processing lambda_val	0.6250
Processing lambda_val	0.6875
Processing lambda_val	0.7500
Processing lambda_val	0.8125
Processing lambda_val	0.8750
