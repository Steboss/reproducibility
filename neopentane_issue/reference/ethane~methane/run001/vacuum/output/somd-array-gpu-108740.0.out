CUDA DEVICES: 0
lambda is:  0.0000
"/home/julien/sire.app/share/Sire/scripts/somd-freenrg.py" 
Reading topology file "../../input/SYSTEM.top" 
Reading coordinate file "../../input/SYSTEM.crd" 
Building 1 molecule(s)... 
 Getting space information  
Read space "Infinite cartesian space" 
...complete 

Loading configuration information from file sim.cfg

 
Running a somd-freenrg calculation using files ../../input/SYSTEM.top, ../../input/SYSTEM.crd and ../../input/MORPH.pert.
Using parameters:
===============
andersen == True
barostat == False
buffered coordinates frequency == 500
center solute == True
constraint == allbonds
crdfile == ../../input/SYSTEM.crd
cutoff type == nocutoff
energy frequency == 100
equilibrate == False
equilibration iterations == 5000
lambda array == (0.0, 0.0625, 0.125, 0.1875, 0.25, 0.3125, 0.375, 0.4375, 0.5, 0.5625, 0.625, 0.6875, 0.75, 0.8125, 0.875, 0.9375, 1.0)
lambda_val == 0.0
minimal coordinate saving == True
minimize == True
morphfile == ../../input/MORPH.pert
ncycles == 100
nmoves == 10000
platform == CUDA
precision == mixed
save coordinates == True
topfile == ../../input/SYSTEM.top
===============

### Running Single Topology Molecular Dynamics Free Energy on node010 ###
###================Setting up calculation=====================###
New run. Loading input and creating restart
lambda is 0.0
Create the System...
Selecting dummy groups
Creating force fields... 
Setting up the simulation with random seed 182257
Setting up moves...
Created a MD move that uses OpenMM for all molecules on 0 
Generated random seed number 182257 
Saving restart
Setting up sim file. 
There are 8 atoms in the group 
###===========================================================###

###====================somd-freenrg run=======================###
Starting somd-freenrg run...
10000 moves 100 cycles, 2000 ps simulation time

Cycle =  1 


Cycle =  2 


Cycle =  3 


Cycle =  4 


Cycle =  5 


Cycle =  6 


Cycle =  7 


Cycle =  8 


Cycle =  9 


Cycle =  10 


Cycle =  11 


Cycle =  12 


Cycle =  13 


Cycle =  14 


Cycle =  15 


Cycle =  16 


Cycle =  17 


Cycle =  18 


Cycle =  19 


Cycle =  20 


Cycle =  21 


Cycle =  22 


Cycle =  23 


Cycle =  24 


Cycle =  25 


Cycle =  26 


Cycle =  27 


Cycle =  28 


Cycle =  29 


Cycle =  30 


Cycle =  31 


Cycle =  32 


Cycle =  33 


Cycle =  34 


Cycle =  35 


Cycle =  36 


Cycle =  37 


Cycle =  38 


Cycle =  39 


Cycle =  40 


Cycle =  41 


Cycle =  42 


Cycle =  43 


Cycle =  44 


Cycle =  45 


Cycle =  46 


Cycle =  47 


Cycle =  48 


Cycle =  49 


Cycle =  50 


Cycle =  51 


Cycle =  52 


Cycle =  53 


Cycle =  54 


Cycle =  55 


Cycle =  56 


Cycle =  57 


Cycle =  58 


Cycle =  59 


Cycle =  60 


Cycle =  61 


Cycle =  62 


Cycle =  63 


Cycle =  64 


Cycle =  65 


Cycle =  66 


Cycle =  67 


Cycle =  68 


Cycle =  69 


Cycle =  70 


Cycle =  71 


Cycle =  72 


Cycle =  73 


Cycle =  74 


Cycle =  75 


Cycle =  76 


Cycle =  77 


Cycle =  78 


Cycle =  79 


Cycle =  80 


Cycle =  81 


Cycle =  82 


Cycle =  83 


Cycle =  84 


Cycle =  85 


Cycle =  86 


Cycle =  87 


Cycle =  88 


Cycle =  89 


Cycle =  90 


Cycle =  91 


Cycle =  92 


Cycle =  93 


Cycle =  94 


Cycle =  95 


Cycle =  96 


Cycle =  97 


Cycle =  98 


Cycle =  99 


Cycle =  100 

Simulation took 404 s 
###===========================================================###

Clearing buffers...
Backing up previous restart
Saving new restart
Starting /home/julien/sire.app/bin/somd-freenrg: number of threads equals 32
"/home/julien/sire.app/share/Sire/scripts/analyse_freenrg.py" 
!!!WARNING: at the moment the gradietns values are multiply by 0.593 kcal/mol!!!
Looking for simfile.dat files
Found in these folders simfile.dat

['/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.0000/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.0625/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.1250/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.1875/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.2500/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.3125/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.3750/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.4375/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.5000/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.5625/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.6250/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.6875/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.7500/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.8125/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.8750/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.9375/simfile.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-1.0000/simfile.dat']
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.0000.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.0625.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.1250.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.1875.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.2500.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.3125.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.3750.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.4375.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.5000.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.5625.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.6250.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.6875.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.7500.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.8125.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.8750.dat
/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/analysis_gro/lambda-0.9375.dat
Traceback (most recent call last):
  File "analysis_alchemical.py", line 50, in <module>
    index_start = read_file.index('#   [step]      [potential kcal/mol]       [gradient kcal/mol]      [forward Metropolis]     [backward Metropolis]                   [u_kl]\n') +1
ValueError: '#   [step]      [potential kcal/mol]       [gradient kcal/mol]      [forward Metropolis]     [backward Metropolis]                   [u_kl]\n' is not in list
Started on Thu Apr 28 10:24:23 2016
Reading metadata from ./lambda-0.6250.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.4375.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.0000.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.1875.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.5000.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.8750.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.5625.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.0625.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.2500.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.8125.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.3750.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.9375.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.6875.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.7500.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.1250.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...
Reading metadata from ./lambda-0.3125.dat; first 0 ps (0 snapshots) will be discarded due to equilibration...

Loading in data from ./lambda-0.0000.dat (state 0) ...
Loading in data from ./lambda-0.0625.dat (state 1) ...
Loading in data from ./lambda-0.1250.dat (state 2) ...
Loading in data from ./lambda-0.1875.dat (state 3) ...
Loading in data from ./lambda-0.2500.dat (state 4) ...
Loading in data from ./lambda-0.3125.dat (state 5) ...
Loading in data from ./lambda-0.3750.dat (state 6) ...
Loading in data from ./lambda-0.4375.dat (state 7) ...
Loading in data from ./lambda-0.5000.dat (state 8) ...
Loading in data from ./lambda-0.5625.dat (state 9) ...
Loading in data from ./lambda-0.6250.dat (state 10) ...
Loading in data from ./lambda-0.6875.dat (state 11) ...
Loading in data from ./lambda-0.7500.dat (state 12) ...
Loading in data from ./lambda-0.8125.dat (state 13) ...
Loading in data from ./lambda-0.8750.dat (state 14) ...
Loading in data from ./lambda-0.9375.dat (state 15) ...

Estimating the free energy change with TI-CUBIC...
------------ ----------------------- 
   States      TI-CUBIC (kcal/mol)   
------------ ----------------------- 
   0 -- 1        -0.2498  +-  0.0007 
   1 -- 2        -0.1624  +-  0.0005 
   2 -- 3        -0.1238  +-  0.0004 
   3 -- 4        -0.1051  +-  0.0004 
   4 -- 5        -0.0976  +-  0.0004 
   5 -- 6        -0.0970  +-  0.0004 
   6 -- 7        -0.1001  +-  0.0004 
   7 -- 8        -0.1021  +-  0.0004 
   8 -- 9        -0.1050  +-  0.0004 
   9 -- 10       -0.1092  +-  0.0004 
  10 -- 11       -0.1139  +-  0.0005 
  11 -- 12       -0.1179  +-  0.0005 
  12 -- 13       -0.1219  +-  0.0005 
  13 -- 14       -0.1276  +-  0.0005 
  14 -- 15       -0.1320  +-  0.0005 
------------ ----------------------- 
    TOTAL:       -1.8654  +-  0.0022 

************************************
   The above table has been stored in   
             ./results.txt              
     while the full-precision data      
 (along with the simulation profile) in 
            ./results.pickle            
************************************

Time spent: 0 hours, 0 minutes, and 4.01 seconds.
Finished on Thu Apr 28 10:24:27 2016
Submitted batch job 108773
Traceback (most recent call last):
  File "extract_results.py", line 39, in <module>
    mbar = open("freenrg-MBAR.dat", "r")
IOError: [Errno 2] No such file or directory: 'freenrg-MBAR.dat'
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/lib/npyio.py:945: UserWarning: loadtxt: Empty input file: "/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-1.0000/gradients.dat"
  warnings.warn('loadtxt: Empty input file: "%s"' % fname)
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/core/_methods.py:59: RuntimeWarning: Mean of empty slice.
  warnings.warn("Mean of empty slice.", RuntimeWarning)
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/core/_methods.py:70: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/core/_methods.py:82: RuntimeWarning: Degrees of freedom <= 0 for slice
  warnings.warn("Degrees of freedom <= 0 for slice", RuntimeWarning)
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/core/_methods.py:94: RuntimeWarning: invalid value encountered in true_divide
  arrmean, rcount, out=arrmean, casting='unsafe', subok=False)
/home/steboss/.local/lib/python2.7/site-packages/numpy-1.12.0.dev0+1b6831b-py2.7-linux-x86_64.egg/numpy/core/_methods.py:116: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
Looking for gradients.dat files
Found in these folders gradients dat

['/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.0000/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.0625/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.1250/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.1875/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.2500/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.3125/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.3750/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.4375/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.5000/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.5625/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.6250/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.6875/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.7500/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.8125/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.8750/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-0.9375/gradients.dat', '/home/steboss/projects/reproducibility/neopentane_issue/ethane~methane/run001/vacuum/output/lambda-1.0000/gradients.dat']
Processing lambda_val	0.0000
Processing lambda_val	0.0625
Processing lambda_val	0.1250
Processing lambda_val	0.1875
Processing lambda_val	0.2500
Processing lambda_val	0.3125
Processing lambda_val	0.3750
Processing lambda_val	0.4375
Processing lambda_val	0.5000
Processing lambda_val	0.5625
Processing lambda_val	0.6250
Processing lambda_val	0.6875
Processing lambda_val	0.7500
Processing lambda_val	0.8125
Processing lambda_val	0.8750
Processing lambda_val	0.9375
Processing lambda_val	1.0000
